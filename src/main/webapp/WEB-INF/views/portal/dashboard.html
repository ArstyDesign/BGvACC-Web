<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/springsecurity"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{templates/portalTemplate}">
  <head>
    <title th:text="#{app.title(#{app.portal.title(#{portal.dashboard.title})})}">Bulgaria vACC â€“ Bulgarian Virtual Area Control Center</title>
  </head>
  <body>
    <div layout:fragment="contentDiv">

      <div class="row">
        <div class="col-sm-6 col-xl-3 mb-3 mb-lg-5">
          <div class="card card-body">
            <h6 class="mb-3">
              <span th:text="#{portal.dashboard.totalatcsessions}">Total ATC Sessions</span>
              <span class="material-symbols-rounded ms-2 fs-6 align-middle opacity-75" th:data-tippy-content="#{portal.dashboard.totalatcsessions.desc}" data-tippy-placement="top">info</span>
            </h6>
            <div class="d-flex lh-1 align-items-center">
              <h4 class="mb-0" th:text="${totalATCSessionsCount}">245</h4>
            </div>
          </div>
        </div>
        <div class="col-sm-6 col-xl-3 mb-3 mb-lg-5">
          <div class="card card-body">
            <h6 class="mb-3">
              <span th:text="#{portal.dashboard.totaleventsapplications}">Total events applications</span>
              <span class="material-symbols-rounded ms-2 fs-6 align-middle opacity-75" th:data-tippy-content="#{portal.dashboard.totaleventsapplications.desc}" data-tippy-placement="top">info</span>
            </h6>
            <div class="d-flex lh-1 align-items-center">
              <h4 class="mb-0" th:text="${#numbers.formatInteger(totalUserEventApplications, 0, 'WHITESPACE')}">1 543</h4>
            </div>
          </div>
        </div>
        <div class="col-sm-6 col-xl-3 mb-3 mb-lg-5">
          <div class="card card-body">
            <h6 class="mb-3">
              <span th:text="#{portal.dashboard.staffcount}">Staff count</span>
              <span class="material-symbols-rounded ms-2 fs-6 align-middle opacity-75" th:data-tippy-content="#{portal.dashboard.staffcount.desc}" data-tippy-placement="top">info</span>
            </h6>
            <div class="d-flex lh-1 align-items-center">
              <h4 class="mb-0" th:text="${#numbers.formatInteger(staffCount, 0, 'WHITESPACE')}">5</h4>
            </div>
          </div>
        </div>
        <div class="col-sm-6 col-xl-3 mb-3 mb-lg-5">
          <div class="card card-body">
            <h6 class="mb-3">
              <span th:text="#{portal.dashboard.userscount}">Users count</span>
              <span class="material-symbols-rounded ms-2 fs-6 align-middle opacity-75" th:data-tippy-content="#{portal.dashboard.userscount.desc}" data-tippy-placement="top">info</span>
            </h6>
            <div class="d-flex lh-1 align-items-center">
              <h4 class="text-muted mb-0" th:text="${#numbers.formatInteger(usersCount.totalUsers, 0, 'WHITESPACE')}">87</h4>

              <div class="vr lh-1 align-self-center opacity-25 mx-3 height-10" style="min-height: auto;"></div>

              <h4 class="text-success mb-0" th:text="${#numbers.formatInteger(usersCount.activeUsers, 0, 'WHITESPACE')}">87</h4>

              <div class="vr lh-1 align-self-center opacity-25 mx-3 height-10" style="min-height: auto;"></div>

              <h4 class="text-danger mb-0" th:text="${#numbers.formatInteger(usersCount.inactiveUsers, 0, 'WHITESPACE')}">87</h4>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-12 mb-3">
          <div class="h3 mb-0" th:text="#{portal.dashboard.events}">Events</div>
          <hr class="my-2"/>
        </div>

        <div class="col-sm-6 col-xl-3 mb-3 mb-lg-5">
          <div class="card card-body">
            <h6 class="mb-3">
              <span th:text="#{portal.dashboard.eventsthisyear}">Events this year</span>
              <span class="material-symbols-rounded ms-2 fs-6 align-middle opacity-75" th:data-tippy-content="#{portal.dashboard.eventsthisyear.desc}" data-tippy-placement="top">info</span>
            </h6>
            <div class="d-flex lh-1 align-items-center">
              <h4 class="mb-0" th:text="${#numbers.formatInteger(eventsYearlyReport.events.total, 0, 'WHITESPACE')}">5</h4>
            </div>
          </div>
        </div>

        <div class="col-sm-6 col-xl-3 mb-3 mb-lg-5">
          <div class="card card-body">
            <h6 class="mb-3">
              <span th:text="#{portal.dashboard.cptsthisyear}">CPTs this year</span>
              <span class="material-symbols-rounded ms-2 fs-6 align-middle opacity-75" th:data-tippy-content="#{portal.dashboard.cptsthisyear.desc}" data-tippy-placement="top">info</span>
            </h6>
            <div class="d-flex lh-1 align-items-center">
              <h4 class="mb-0" th:text="${#numbers.formatInteger(eventsYearlyReport.cpts.total, 0, 'WHITESPACE')}">5</h4>
            </div>
          </div>
        </div>

        <div class="col-sm-6 col-xl-3 mb-3 mb-lg-5">
          <div class="card card-body">
            <h6 class="mb-3">
              <span th:text="#{portal.dashboard.monthwithmostevents}">Month with most Events</span>
              <span class="material-symbols-rounded ms-2 fs-6 align-middle opacity-75" th:data-tippy-content="#{portal.dashboard.monthwithmostevents.desc}" data-tippy-placement="top">info</span>
            </h6>
            <div class="d-flex lh-1 align-items-center">
              <h4 class="mb-0" th:text="#{month. + ${eventsYearlyReport.monthWithMostEvents}}">5</h4>
            </div>
          </div>
        </div>

        <div class="col-sm-6 col-xl-3 mb-3 mb-lg-5">
          <div class="card card-body">
            <h6 class="mb-3">
              <span th:text="#{portal.dashboard.monthwithmostcpts}">Month with most CPTS</span>
              <span class="material-symbols-rounded ms-2 fs-6 align-middle opacity-75" th:data-tippy-content="#{portal.dashboard.monthwithmostcpts.desc}" data-tippy-placement="top">info</span>
            </h6>
            <div class="d-flex lh-1 align-items-center">
              <h4 class="mb-0" th:text="#{month. + ${eventsYearlyReport.monthWithMostCpts}}">5</h4>
            </div>
          </div>
        </div>

        <div class="col-12 mb-3">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0" th:text="#{portal.dashboard.chart.title('' + ${#dates.year(#dates.createNow())})}">Chart Area</h5>
            </div>

            <div id="chart_area"></div>
          </div>
        </div>
      </div>

      <script type="text/javascript" th:inline="javascript">
        /*<![CDATA[*/
        let updateTimeUrl = /*[[@{/api/time}]]*/;
                let eventsCountByMonths = /*[[${eventsCountByMonths}]]*/;
                let cptsCountByMonths = /*[[${cptsCountByMonths}]]*/;
                let vasOpsCountByMonths = /*[[${vasOpsCountByMonths}]]*/;
                let columnEvents = /*[[#{portal.dashboard.chart.events}]]*/;
                let columnCpts = /*[[#{portal.dashboard.chart.cpts}]]*/;
                let months = /*[[${months}]]*/;
                let aux2 = /*[[@{/}]]*/;
        /*]]>*/

        var cPrimary = "var(--bs-primary)";
        var cSuccess = "var(--bs-success)";

        //Chart Area
        var optionsArea = {
          colors: [cPrimary, cSuccess],
          series: [{
              name: columnEvents,
              data: eventsCountByMonths,
            },
            {
              name: columnCpts,
              data: cptsCountByMonths,
            },
          ],

          chart: {
            type: 'area',
            height: 350,
            fontFamily: 'Inherit',
            toolbar: {
              show: false
            }
          },
          dataLabels: {
            enabled: false
          },
          stroke: {
            width: 3,
            curve: 'smooth',
          },
          grid: {
            strokeDashArray: 2,
            padding: {
              left: 16,
              top: 0,
              bottom: 10,
              right: 0
            },
            xaxis: {
              lines: {
                show: true,
              },
            },
            yaxis: {
              lines: {
                show: false,
              },
            },
          },
          labels: months,

          yaxis: {
            labels: {
              show: true,
              offsetX: 6
            },
          },
          xaxis: {
            tickAmount: 12,
            labels: {
              show: true,
              rotate: 0
            },
            tooltip: {
              enabled: false
            },
            axisTicks: {
              show: false,
            },
            axisBorder: {
              show: false,
            },
          },
          fill: {
            type: 'gradient',
            gradient: {
              opacityFrom: 0.1,
              opacityTo: 0,
              stops: [0, 100]
            }
          },
          tooltip: {
            shared: true,
            intersect: false,
            y: {
              formatter: function (val) {
                return val + ' <span class="fw-normal text-muted"></span>';
              },
            },
          },
          markers: {
            strokeWidth: 5,
            strokeOpacity: 1,
            strokeColors: ['#ffffff', '#ffffff', '#ffffff'],
          },
        };

        var chartArea = new ApexCharts(document.querySelector('#chart_area'), optionsArea);
        chartArea.render();

      </script>
    </div>
  </body>
</html>